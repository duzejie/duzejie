参考资料
[设计VLSI EDA(1)：EDA的What, Why, How - 知乎 (zhihu.com)](https://zhuanlan.zhihu.com/p/380962676)
[设计VLSI EDA(7): 布局算法怎么实现芯片“核舟记” - 知乎 (zhihu.com)](https://zhuanlan.zhihu.com/p/578525808)

![[5b364be15160338fa3c641cc6b212c4d_MD5.jpg]]
## IC设计流程
---

![[Pasted image 20230321234603.png]]

-   数字 IC 设计流程  
	- [[规格制定]]：根据客户向芯片设计公司（称为 `Fabless`，无晶圆设计公司）提出的设计要求，包括具体功能和性能方面的要求，例如：成本控制在什么水平，需要多少 TOPS 的 AI 算力，是否功耗敏感，支持哪些联接方式，系统需要遵循的安全等级等，制定芯片规格。
		  芯片工程师在芯片设计开始的时候，就会做好芯片的需求分析、完成产品规格定义，以此确定芯片设计的整体方向。比如芯片成本控制在什么水平、支持哪些联接方式以及系统所需要遵循的安全等级。
		-  明确项目需求：确定芯片的具体指标（spec）：  
			-   物理：工艺、面积、封装；  
			-   性能：速度、功耗；  
			-   功能：功能表述、接口定义。
		- **工艺选择**：     正向设计在一开始的整体规划中就要考虑工艺的问题，这涉及到有关工艺的相关知识，有些工艺就是特别为某种类型的芯片而开发的。往往工艺的选择会特别耗时间，会有各种参数的考量，例如工艺生产周期，工艺的成品率，工艺生产时间的安排等等各方面的考究。这部分，需要花费特别多的时间。工艺由芯片制造厂提供，前提是必须和芯片制造厂有合作关系  

	- [[系统级设计]]（详细设计）：在前期规格定义的基础上，明确芯片的架构、业务模块以及供电等系统级设计，例如 CPU、GPU、NPU、RAM、联接、接口。芯片在设计的过程中需要综合考量芯片的系统交互功能、成本、功耗、性能、安全及可维可测等综合要素。
		- **[[架构设计]]**：架构工程师制定方案，设计架构，划分模块功能，定义接口时序。
			- 常见 3 类架构
				- 数据流：数据从输入到输出是一条直线，并没有折回的数据，这是纯数据处理的一种架构，这种芯片功能应该是比较单一
				- 控制流：这是基于状态机或者 CPU 形式的一种架构设计。简单点的芯片就采用状态机就够了，复杂的就必须采用 CPU 作为控制内核了，比如单片机就是以 CPU 为控制内核，外加 RAM,ROM 所形成的一类控制类芯片  
				- 总线流：基于总线的芯片设计架构，最熟悉的就是 SOC 类芯片，总线上连接着一个或多个 CPU, RAM, ROM，I 2 C，UART 等等之类的各种组件。由这些组件的不同排列组合，形成满足各种不同需求的芯片，例如不同的 ARM 类芯片
			- 指令集架构
			- 微架构  [[Microarchitecture]] ：一种给定的指令集架构在处理器中执行的方法。相同的指令集可以在不同的微架构中执行，但实施的目的和效果可能不同。优秀的微架构对 CPU 性能和效能提升发挥着至关重要的作用。_计算机体系是微架构和指令集的结合。
		- **算法设计**，我所略知的是**通信类**的，例如，**FIR，FFT，小波变换，三角函数变换**等。这类算法都是**以数据处理为主要目的**，所以这些算法都**要求有较强的数学功底**。**做算法开发，主要工具为 MATLAB**，都是先在 MATLAB 上做原型开发验证，再转化为 RTL 级的代码  

		- [[系统级建模]]， [[electronic system-level design]] (ESL，芯片建模）：用系统建模语言对各模块进行描述。  
			- ESL
		- 性能和功耗评估
		- 
	- [[前端设计]]：RTL 设计、仿真、硬件原型验证、电路综合。![](https://api2.mubu.com/v3/document_image/06cedf98-59c3-4155-80d5-403a868fd41e-12580695.jpg) 
		- [[RTL 设计]]：又称 RTL 实现/ HDL 编码，即使用硬件描述语言（VHDL，Verilog HDL，业界公司一般都是使用后者）来实现模块功能，也就是将实际的硬件电路功能通过 HDL 语言描述出来，形成 RTL（寄存器传输级）代码。  
			- 在[[系统级设计]]完成后，划分出的各个功能模块将进入 RTL 流程。即前端设计工程师利用硬件描述语言（一种能够描述逻辑器件的语言，如 VerilogHDL 语言），对包含两类基本逻辑器件，即 #组合逻辑 器件 （输出信号只受输入信号当前状态影响的逻辑器件）和 #时序逻辑 器件 （输出信号不仅和输入信号当前时刻的状态有关，还和其前一时刻状态有关），的数字集成电路进行描述。而这种描述是以寄存器（由多个存放1位二进制代码的触发器组成）之间的传输为基础的，因此称为 RTL（寄存器传输级）设计。![](https://api2.mubu.com/v3/document_image/45699e1f-aad5-48bb-92b5-ba7cf3592ee2-12580695.jpg)  
			- 寄存器传输级设计是集成电路设计（Integrated circuit design）中进行逻辑设计的步骤之一。它是一种对同步数位电路的抽象模型，这种模型是根据数字信号在硬件寄存器、存储器、组合逻辑装置和总线等逻辑单元之间的流动，以及其逻辑代数运作方式来确定的。一个寄存器传输级的描述通常会通过逻辑综合工具转换成逻辑门级电路连线网表的描述。然后，这一步的成果再经过布线等步骤，得到物理的电路。 

			- 集成电路设计的等价性检验是重要的形式化验证方法。由于系统级模型和寄存器传输级(RTL)实现之间存在很大的语义差别,并且不存在结构相似性,这两者之间的等价性检验面临许多挑战。  

			- Coding Style check：目的是排除 RTL 代码中的 CDC（Clock Domain Cross 时钟域交叉）、Lint（代码潜在问题）等问题。  

		- [[数字IC验证]]：检验编码设计的正确性，检验的标准就是第一步制定的规格。看设计是否精确地满足了规格中的所有要求。规格是设计正确与否的 #黄金标准 ，一切违反，不符合规格要求的，就需要重新修改设计和编码。设计和仿真验证是反复迭代的过程，直到验证结果显示完全符合规格标准。该部分称为前仿真，接下来逻辑部分综合之后再一次进行的仿真可称为后仿真。IC 设计中的两次仿真统称为 Signoff（签核）  
			- [[功能验证]]：（前仿真）  
				- 按验证方法可分为  
					- 目的性验证：目的是验证设计所试图完成的功能在设计中已正确实现。最典型的情况是在抽象程度最高的层次完成，其最终结果是建立一套“黄金模型”，它可以在整个设计过程中作为设计细节的参考。  
						- 动态验证 ：动态验证是在一系列激励的作用下（依靠仿真器），对数字电路（一个设计方案的一个或几个模块、某设计的硬件实现等几个方面）的测试。
							- [[功能仿真]]
							- 硬件加速：硬件加速是特指为加速某些仿真操作而将设计中部分或全部的模块映射到硬件平台上。最典型情况就是测试平台仍然保留在软件中运行，而被验证的设计却是在硬件加速器中运行。有些类型的加速器也能运行行为级的代码，这种情况下，具体的时钟周期的行为表现并没有给出详细的说明，因此，有可能会全部在硬件加速器中运行纯确定性或随机模式仿真。例如 [[功能验证#3 FPGA原型验证 (FPGA Prototyping)]].
							- 硬件建模：有些软件仿真模型的设计元件难以实现，或者不够精确。解决这个难题的方法就是运行硬件模型中的一个半导体元件，将它连接到软件仿真器上。这个硬件模型的输入是接收来自仿真器的信号，然后将该信号送到半导体元件中运行一个周期，最后获得输出信号并将它送回仿真器。  

						- 动态－形式化混合验证：为了更好的发挥形式化验证技术全面性的特点，在处理大型设计、更加广泛的设计风格的设计时使用。（符号仿真、半形式化仿真 ）  
						- [[软硬件协同]]验证：在传统的系统设计的串行流程中，首先构造硬件，然后在硬件的基础上编写和调试系统软件。但是在软、硬件联合验证技术中，对系统硬件和软件的验证是同时进行的。在硬件被开发的同时，相应的软件也在硬件仿真平台中执行，这样就实现了硬件和软件的并行调试。  
						- [[功能验证#4 硬件仿真 (Emulation)|硬件仿真]]：硬件仿真器是通常由某些可重构逻辑（通常为现场可编程门阵列，如 FPGA）组成的专门设计的硬件和软件系统。编程这些系统以模仿设计目标的行为和功能，甚至达到将仿真过的设计同设计即将在其中操作的系统的剩余部分直接连接的程度。由于这些系统是以硬件为基础的，因此，它们能够提供与最终设计目标接近的电路仿真速度。  
						- 物理样机  
						- 虚拟样机  
						- 
					- [[等价性验证]]：目的是验证设计过程中产生的不同层次的设计结果功能是否符合“ #黄金标准 ”。  
						-  [[功能验证#1 静态验证 (Static Verification)|静态验证]]：静态功能验证利用公式化的数学技巧来进行验证而不使用验证测试序列。其测试方法还没有统一的工业标准，说法比较含糊。  
							- [[形式验证]] ：同样属于验证范畴，它是从功能上（STA 是时序上）对综合后的网表进行验证。常用的就是[[等价性验证]]方法，以功能验证后的 HDL 设计为参考，对比综合后的网表功能，他们是否在功能上存在等价性。这样做是为了保证在逻辑综合过程中没有改变原先 HDL 描述的电路功能。  
								- 等效性检查（Logical Equivalence Check，LEC)属于集成电路设计中形式验证的一种形式。通过一些数学方法（如二元决策图、布尔可满足性问题），来对不同电路之间进行形式验证，比较它们在行为上是否等效。在集成电路流程中的各个阶段，都可以用到等效性检查。![|600](https://api2.mubu.com/v3/document_image/66430c28-94e7-4c6c-9726-509d446eceb9-12580695.jpg)
						- [形式化等性检验：](https://mubu.com/app/edit/home/4MLRhSWbag0#o-yhsPufC7zD)包括布尔等价性检验和时序等价性检验。  ref.[[形式验证]] 
						- [物理验证：](https://mubu.com/app/edit/home/4MLRhSWbag0#o-QFqNLi0Iuz)通过检验图形设计的数据库以确信物理实现确实是原始逻辑设计的正确表述。物理验证包括以下三个部分：电学规则检验（简称 ERC）、设计规则检验（简称 DRC）及布线和电路图检验（简称 LVS）。  

				- 按验证对象分可分为：  
					- IP验证：对某个 IP 的功能（如：单元测试）进行验证的过程。 
					- 系统验证：对包含一个或多个 IP 的 SoC 进行功能验证的过程。  
				- 
				- [[形式验证]] VS 仿真：![](https://api2.mubu.com/v3/document_image/b4779808-dbaa-4236-aacf-e2ea38dc53b6-12580695.jpg)  
					- 形式验证是指从数学上完备地证明或验证电路的实现方案是否确实实现了电路设计所描述的功能。SoC 验证的形式化方法主要是等价性检查和模型检查。等价性检查主要是检查两个门级网表之间是否一致，保证网表处理后不会改变电路的功能，或者保证网表能正确地实现 RTL 代码所描述的功能，或者保证两种 RTL 描述逻辑一致。模型检查主要是检查 RTL 代码是否满足规范中规定的一些特性。在规定这些特性时一般使用特性规范语言，一般也使用基于断言的验证语言。  

					- 提到形式验证的模型检验，绕不开和传统的仿真验证方式的比较。仿真验证依靠施加各种类型的激励，以尽量高的覆盖设计者想验证的逻辑功能。这种方法自然 coverage 很难达到 100%，而形式验证理论上可以达到 100% coverage。但是现实应用中，并非设计的每个部分都可以模拟，而且仿真能够为设计者节省更多的时间以及时投放市场。  
			- [[静态时序分析]] ——STA：Static Timing Analysis（STA），静态时序分析，也属于验证范畴，它主要是在时序上对电路进行验证，检查电路是否存在建立时间（setuptime）和保持时间（holdtime）的违例（violation）。当一个寄存器出现这两个时序违例时，是没有办法正确采样数据和输出数据的，所以以寄存器为基础的数字芯片功能肯定会出现问题。![](https://api2.mubu.com/v3/document_image/f9492447-0ed5-4aaa-8494-ef886b5efd57-12580695.jpg)  

			- #前仿真 vs #后仿真 ：  
				- 前端仿真指的是进行 RTL 仿真，在这种仿真当中是没有真实延时情况的。对于一个寄存器（register），它的输出端（Q port）相对它的时钟输入端（Clk port）的延时为零延时（delta delay）。  
				- #后仿真 指的是进行 Gate 仿真。在实际项目中，由于后端综合进而产生 SDF 文件本身需要不断迭代周期，我们进一步又将门级仿真划分为零延时仿真和 SDF 仿真。  
					- 零延时仿真是只有门级网表参与仿真，没有 SDF 文件来具体反向标注（back annotation）门级延时情况，所以门之间的延时仍然为零延时，这个时候门级零延时仿真与 RTL 仿真的区别仅在于前者是后者的逻辑映射，从寄存器级别到门级的逻辑转译，这一步是由后端的综合工具（synthesis tooling）完成的。  
					- 当后端随后产生出 SDF 文件时，我们会将门级网表反向标注上 SDF 文件中包含的每一条门单元之间路径的延时，最终进行有真正延时电路的仿真。  
				- 从验证完整性而言，前端仿真和后端仿真均需要在项目中实施，而它们侧重的目标也有不同。**前端仿真是为了检测出功能逻辑的缺陷，而后端仿真是为了检测出实际门级电路中由于延时问题可能导致采样失败进而产生的功能缺陷**。也因此验证人员不能将前端仿真的功能缺陷检测任务下移到后端仿真阶段，因为就效率问题而言，前端仿真要显著高于后端仿真；同时，后端仿真之所以不能忽略是因为它可以协助后端人员来测试出实际生成电路中是否有时序不满足的问题。  

		- [[820_IC/26-逻辑综合/逻辑综合]] ：仿真验证通过，进行逻辑综合。逻辑综合的结果就是把设计实现的 HDL 代码翻译成门级网表 netlist。综合需要设定约束条件，就是设计者希望综合出来的电路在面积，时序等目标参数上达到的标准。逻辑综合需要基于特定的综合库，不同的库中，门电路基本标准单元（standardcell）的面积，时序参数是不一样的。所以，选用的综合库不一样，综合出来的电路在时序，面积上是有差异的。逻辑综合完成后，需要做 #后仿真   ![](https://api2.mubu.com/v3/document_image/d574f92a-3858-46bc-a5db-87ee46b32715-12580695.jpg)
		-  [[可测性设计]]：Design For Test（DFT），可测性设计。芯片内部往往都自带测试电路，DFT 的目的就是在设计的时候就考虑将来的测试。DFT 的常见方法就是，在设计中插入扫描链，将非扫描单元（如寄存器）变为扫描单元。
	- [[后端设计]] （auto placement and route，APR或者PR，physical design，pd）：版图设计、物理验证、后仿真。![后端设计|600](https://api2.mubu.com/v3/document_image/b99429d4-c58e-4616-b3a7-a670afc74c3f-12580695.jpg)  
		- 物理实现：由门级网表到物理版图的过程，最后以GDSII的文件格式交给芯片代工厂（称为Foundry）在晶圆硅片上做出实际的电路。
			- 布图规划 **floor plan**：布图规划就是放置芯片的宏单元模块，在总体上确定各种功能电路的摆放位置，如 IP 模块，RAM，I/O 引脚等等。布图规划能直接影响芯片最终的面积。  
			- 布局 **placement** ：The gates in the netlist are assigned to nonoverlapping locations on the die area.
			- Logic/placement refinement: Iterative logical and placement transformations to close performance and power constraints.
			- 电源规划
			- 时钟树综合 (Clock Tree Synthesis， CTS) ：简单点说就是时钟的布线。由于时钟信号在数字芯片的全局指挥作用，它的分布应该是对称式的连到各个寄存器单元，从而使时钟从同一个时钟源到达各个寄存器时，时钟延迟差异最小。这也是为什么时钟信号需要单独布线的原因。
			- 布线 **route**：这里的布线指普通信号布线了，包括各种标准单元（基本逻辑门电路）之间的走线。比如0.13um 工艺，或者说90nm 工艺，实际上就是这里金属布线可以达到的最小宽度。The wires that connect the gates in the netlist are added.

		- 寄生参数提取：由于导线本身存在的电阻，相邻导线之间的互感,耦合电容在芯片内部会产生信号噪声，串扰和反射。这些效应会产生信号完整性问题，导致信号电压波动和变化。提取寄生参数进行再次的分析验证，分析信号完整性问题是非常重要的。  
		- 后端验证 
			- 版图物理验证 Physical Verification：对完成布线的物理版图进行功能和时序上的验证，验证项目很多，如 LVS（Layout Vs Schematic）验证，DRC（Design Rule Checking）、ERC（Electrical Rule Checking）。  
				- ERC 电气规则检查，检查图形数据库是否有与电学设计规则相违背之处。包含检验是否有无用输入，浮点输入和装载冲突等。还检验连接是否合法，如短路和短接。  
				- DRC 设计规则检查，检查连线间距，连线宽度等是否满足工艺要求；检查是否与设计流程规则相违背之处。这些规则收集在 DRC 规则文件中，并包含层与层之间的空间检验、布线宽度、层与层的相互重叠等。  
				- LVS（Layout Vs Schematic）验证，简单说，就是版图与逻辑综合后的门级电路图的对比验证。  
			- 
			- [[形式验证]]：验证芯片功能的一致性
			- 电路功耗分析
			- [[静态时序分析]]
			- DFM（可制造性设计）
			- Co-simulation and timing

		- 工程变更命令：(Engineering Change Orders， #ECO ，工程变更单)是在工程变更请求（对工程产品或工艺进行变更的正式请求）得到批准后需要提供的变更所需的细节和规范，其中还包含对更改如何改进产品或过程以及更改可能花费的成本的分析。许多公司通过使用电子 ECO 系统来简化流程，允许多个用户对同一个文档提出更改建议。一旦涉及到的所有人都处理和批准了对 ECO 的更改，则完成了工程更改单并可以进行更改。从添加或移除设计中的逻辑，到清除布线以改善信号完整性等更细微的变化。所有 ECO 都是为了尽快将产品推向市场，同时将采取纠正措施和延误工期的风险降至最低。  

    - 封装和测试  

-   模拟 IC 设计流程  
	- [[820_IC/40-模拟电路/Spice]]

-   IC、PCB与系统![](https://api2.mubu.com/v3/document_image/a8e06a0e-4805-4627-a858-a9e97f82c6e4-12580695.jpg)  
