---
title: 第三章：标准单元库 
author: Sunglow
top: false
cover: false
toc: false
mathjax: false
summary: 'null'
categories:
  - 集成电路
  - 时序分析
tags:
  - 集成电路
  - 时序分析
date: 2018-02-21 21:25:13
keywords:
---
<div>
<style>
img{
    width: 60%;
    //padding-left: 20%;
}
</style>
</div>


# 第三章：标准单元库 

> 本章节介绍库（library）里单元描述中所提供的时序信息。单元可以是标准单元、IO缓冲器或者是如USB内核这样的复杂IP。



●除时序信息外，库单元描述中还包含一些其它属性，例如单元面积和功能，这些属性与时序无关，但在RTL综合（synthesis）过程中会用到。在本章节中，我们仅关注与时序和功耗计算有关的那些属性。

●可以使用各种标准格式来描述库单元，各种格式的内容基本相似，本书中使用**Liberty**语法描述库单元。

●本章节的前面部分介绍了线性和非线性时序模型，随后介绍了用于纳米技术的高级时序模型，这些将在3.7节中进行介绍。

## 3.1 引脚电容

单元的每个输入和输出都可以在引脚（pin）上指定电容。在大多数情况下，仅为单元输入引脚指定电容，而不为输出引脚指定电容，即大多数单元库中的输出引脚电容为0。

![img](docs/IC/25-STA/SAT时序圣经%20翻译/03标准单元库/v2-bfe979da5008b8fa29d9479e725dab45_1440w.jpg)

上面的示例展示了输入INP1引脚电容值的一般规格（specification）。在最基本的格式中，引脚电容被指定为单个值（在上面的示例中为0.5个单位）。电容单位通常为皮法拉（pF），一般在库文件的开头指定。单元描述中还可以为**rise_capacitance**（0.5个单位）和**fall_capacitance**（0.45个单位）分别指定值，这些值是指引脚INP1上发生电平上升和下降跳变时的值。也可以将**rise_capacitance**和**fall_capacitance**的值指定为范围，并在描述中指定下限值和上限值。

## 3.2 时序模型

逻辑单元的时序模型（timing model）旨在为设计中的各种单元实例（instance）提供准确的时序信息。通常会从单元的详细电路仿真中获得时序模型，用以对单元工作时的实际情况进行建模，且需要为逻辑单元的每个时序弧都建立一个时序模型。

![img](docs/IC/25-STA/SAT时序圣经%20翻译/03标准单元库/v2-92ec460c49e3f987d1c0d9c9881886f2_1440w.jpg)

图3-1

让我们首先考虑图3-1中所示的反向器（inverter）的时序弧。 由于这是一个反相器，因此输入端的电平上升（下降）跳变会导致输出端的电平下降（上升）跳变。表征这个反相器的两种延迟是：

●Tr：输出上升沿延迟

●Tf：输出下降沿延迟

注意，延迟是根据单元库中定义的阈值（threshold）点（详见2.4节）测量的，通常为50％Vdd。 因此，延迟值是指从输入经过其阈值点到输出经过其阈值点的延迟。

通过反相器的时序弧的延迟取决于两个因素：

> 1.输出负载，即反相器输出引脚上的电容负载 
2.输入信号的过渡（transition）时间

延迟值与负载电容有直接关系：负载电容越大，延迟越大。在大多数情况下，延迟会随着输入信号过渡时间的增加而增加。而在某些情况下，输入信号阈值点（用于测量延迟）与单元的内部开关点（switching point）明显不同。在这种情况下，通过单元的延迟可能相对于输入信号过渡时间表现出`非单调行为`：较大的输入信号过渡时间可能会产生较小的延迟，尤其是在输出负载较小的情况下。

逻辑单元输出引脚的压摆（slew）主要取决于输出引脚电容：输出信号过渡时间会随着输出负载的增加而增加。 因此，在输入端压摆较大（输入信号过渡时间较长）的情况下，选择合适的单元类型及输出负载，可以改善输出端的压摆。图3-2展示了通过调节逻辑单元的输出负载，可以改善或恶化单元输出信号过渡时间的情况。

![img](docs/IC/25-STA/SAT时序圣经%20翻译/03标准单元库/v2-9e1c81985e7f89b97b2fb9bc8196b4b0_1440w.jpg)图3-2

## 3.2.1 线性时序模型

一个简单的时序模型是线性延迟模型（linear delay model），该模型使用含两个参数的线性函数表示逻辑单元的延迟和输出过渡时间，这两个参数是：输入过渡时间（input transition time）和输出负载电容（output load capacitance）。通过逻辑单元的延迟（D）使用线性模型的一般形式如下所示：

 $$D = D_0 + D_1 * S + D_2 * C$$

其中D0，D1，D2是常数，S是输入过渡时间，C是输出负载电容。 对于亚微米（submicron）技术，线性延迟模型在输入过渡时间和输出负载电容的范围内并不准确，因此，目前大多数单元库都使用更复杂的模型，例如非线性延迟模型（non-linear delay model）。

## 3.2.2 非线性延迟模型

大多数单元库都包括表格模型（table model），用于为单元的各种时序弧指定延迟并进行时序检查。一些用于纳米技术的较新的时序库还提供了基于电流源的高级时序模型（例如CCS，ECSM等），本章稍后将对此进行介绍。 这些表格模型被称为**NLDM**（**N**on-**L**inear **D**elay **M**odel），可用于延迟、输出压摆计算或其他时序检查。表格模型中提供了：在单元输入引脚处输入过渡时间和输出引脚处输出负载电容的各种组合下通过单元的延迟。

NLDM模型以二维形式表示，两个独立变量是输入过渡时间和输出负载电容，表中的数值表示延迟。以下是一个典型反相器单元的表格模型示例：

![img-w70](docs/IC/25-STA/SAT时序圣经%20翻译/03标准单元库/v2-bd81fd2c0d2137a52819c239173c5dc7_1440w.jpg )

上面的示例描述了输出引脚OUT的延迟信息。单元描述里的这个部分包含了从引脚INP1到引脚OUT时序弧的上升和下降延迟模型，以及引脚OUT的**max_transition**允许时间。上升和下降延迟有单独的模型（用于输出引脚），分别标记为**cell_rise**和**cell_fall**。索引（index）变量的类型和顺序在以下查找表模板**delay_template_3x3**中进行了描述：

![img](docs/IC/25-STA/SAT时序圣经%20翻译/03标准单元库/v2-2c764e7c9d70c8c4f7e9c928babc4b36_1440w.jpg)

该查找表模板指定了表中的第一个变量是输入过渡时间，第二个变量是输出负载电容。表中数值的给定类似于嵌套循环，其中第一个索引（index_1）为外部循环变量，第二个索引（index_2）为内部循环变量，依此类推。在上面的示例中每个变量都有三个可能值（条目），因此它对应于一个3×3的表。在大多数情况下，表的条目也可按照表的格式设置，然后可以将第一个索引（index_1）视为行索引，而第二个索引（index_2）则等同于列索引。索引值（例如1000）是伪占位符，它们会被**cell_fall**和**cell_rise**延迟表中的实际索引值覆盖。指定索引值的另一种方法是在模板定义中指定索引值，而不是在**cell_rise**和**cell_fall**表中指定索引值，例如以下示例：

![img](docs/IC/25-STA/SAT时序圣经%20翻译/03标准单元库/v2-24c6c3d6821889875c433a68f195fcd1_1440w.jpg)

根据延迟表，输入下降过渡时间为0.3ns且输出负载为0.16pf时，反相器的上升延迟为0.1018ns。 由于输入的下降沿跳变导致反相器输出的上升沿跳变，因此当输入引脚发生下降沿跳变时，应该去查询**cell_rise**延迟表。

将表格中的延迟值表示为输入过渡时间和输出负载电容这两个变量的函数的这种形式称为非线性延迟模型，因为在这些表格中可以看到延迟随输入过渡时间和输出负载电容的非线性变化。

注意，表格模型也可以是3维的，例如一个具有互补输出Q和QN的触发器，这将在3.8节中进行介绍。

NLDM模型不仅可以用于计算延迟，而且还可用于计算逻辑单元输出引脚的过渡时间，该时间同样由输入过渡时间和输出负载电容来表征。因此，还存在着另外一张独立的用于计算单元的输出上升和下降过渡时间的二维表格。

![img](docs/IC/25-STA/SAT时序圣经%20翻译/03标准单元库/v2-a427e79d1b2ca16e74e8a845e3c8d82e_1440w.jpg)

输出过渡时间也同样有两张表：**rise_transition**和**fall_transition**。如第2章所述，过渡时间是根据特定的压摆阈值点（通常为电源的10％-90％）测量的。

综上所述，使用NLDM模型的反相器单元具有下列表格模型：

 ● 上升延迟时间（Rise delay）

 ● 下降延迟时间（Fall delay）

 ● 上升过渡时间（Rise transition）

 ●下降过渡时间（Fall transition）

假设有这么一个反相器单元，其输入过渡时间和输出负载电容如图3-3所示。对于15ps的输入（下降）过渡时间和10fF负载，可从**cell_rise**表中获得输出上升延迟时间，而从**cell_fall**表中可获得20ps输入（上升）过渡时间和10fF负载下的输出下降延迟时间 。

![img](docs/IC/25-STA/SAT时序圣经%20翻译/03标准单元库/v2-79845496ae9d2d5f568e2b7b2842fe3e_1440w.jpg)图3-3

指定单元逻辑功能为“反相”（invert）的信息在哪里呢？该信息可以在时序弧里的**timing_sense**字段中找到，但在某些情况下如果该字段中未指明，则应该也可从引脚功能（pin function）中推断出。

例如对于反相器单元，时序弧为**negative_unate**，这表明输出引脚电平跳变方向与输入引脚电平跳变方向相反。因此，在**cell_rise**表中进行查找时使用的参数是输入引脚的下降过渡时间。

### 查找非线性延迟模型

这个小节通过一个例子来说明表格模型的查找。如果输入过渡时间和输出电容正好与表格条目中的值相对应，则表格查找是很简单的，因为可以直接从表中对应的位置读出时序值。以下示例对应于一般情况，即输入过渡时间和输出电容无法与表格条目中的值对应的情况。在这种情况下，可利用二维插值的方法来得到最终的时序值，一般选择每个维度中两个最接近的表格条目中的值以进行表格插值。考虑输入过渡时间为0.15ns、输出电容为1.16pF的输出下降沿查找表（前文的示例）， 下面复制了与二维插值有关的输出下降过渡表的相应部分。

![img](docs/IC/25-STA/SAT时序圣经%20翻译/03标准单元库/v2-1093cb4698092f7e3ae1403cc4462a63_1440w.jpg)

在下面的公式中，两个index_1值分别表示为x1和x2；两个index_2值分别表示为y1和y2，而对应的表值分别表示为T11，T12，T21和T22。

如果需要在表中查找（x0，y0）的值，则查找值T00只能通过插值获得，计算公式如下：

 T00 = X20 * Y20 * T11   +    X20 * Y01 * T12 +    X01 * Y20 * T21   +    X01 * Y01 * T22

其中

 X01 = （x0 - x1）/（x2 - x1）

 X20 = （x2 - x0） /（x2 - x1）

 Y01 = （y0 - y1）/（y2 - y1）

 Y20 = （y2 - y0）/（y2 - y1）

将0.15ns代入index_1，将1.16pF代入index_2，根据上述公式可计算出fall_transition值为：

 T00 = 0.75 * 0.25 * 0.1937 + 0.75 * 0.75 * 0.7280 + 0.25 * 0.25 * 0.2327 +0.25 * 0.75 * 0.7676 = **0.6043**

请注意，上面的等式对于内插和外推均有效，即当索引值（x0，y0）超出范围时依然成立。例如，当index_1索引值为0.05且index_2索引值为1.7时，fall_transition值计算如下：

 T00 = 1.25 * （-0.25） * 0.1937 + 1.25 * 1.25 * 0.7280 + （-0.25）*（-0.25） * 0.2327 + （-0.25） * 1.25 * 0.7676 = **0.8516**

## 3.2.3 阈值规格和压摆降额

压摆值（slew）基于的是在库中指定的测量阈值点，大多数上一代的库（0.25um或更旧的库）都使用10％和90％作为压摆（或称过渡时间）的测量阈值点。

压摆阈值点的选择对应的是波形的线性部分。随着技术的发展，实际波形最线性的部分通常在30％至70％之间。 因此，大多数新一代时序库都将压摆测量阈值点指定为Vdd的30％和70％。但是，由于之前测得的过渡时间在10％至90％之间，所以需要将查表得到的时间乘以一个系数，才相当于30％至70％的过渡时间，这个系数由`压摆降额系数（slew derate factor）`指定，通常指定为0.5。压摆测量阈值点为30％和70％且压摆降额系数为0.5，等效于测量阈值点为10％和90％。 阈值设置的示例如下：

![img](docs/IC/25-STA/SAT时序圣经%20翻译/03标准单元库/v2-a03731f771bc5ec6aae66aa03b7b36cd_1440w.jpg)

`上面的设置规定了要将表格中的过渡时间乘以0.5，以获得与阈值（30%-70%）设置相对应的过渡时间。`这意味着表格中的值（以及相应的索引值）实际上是10%-90%阈值点的测量值。在标定过渡时间值时，首先在30%-70%处测量，然后再把测量值外推到10％至90％（（70-30）/（90-10）= 0.5）。

以下是压摆测量阈值点设置的另一个例子：

**slew_lower_threshold_pct_fall**：20.0；

**slew_upper_threshold_pct_fall**：80.0；

**slew_lower_threshold_pct_rise**：20.0；

**slew_upper_threshold_pct_rise**：80.0；

**slew_derate_from_library** not specified

在上述20%-80%压摆阈值设置的例子中，未指定**slew_derate_from_library**（默认值为1.0），这意味着库中的过渡时间不会降额（derate）。表格中的过渡时间值直接对应于20%-80%的阈值点，如图3-4所示：

![img](docs/IC/25-STA/SAT时序圣经%20翻译/03标准单元库/v2-04e19d6eed9852b5787ded76cae208c8_1440w.jpg)图3-4

对上述单元库中压摆阈值设置稍作修改，如下所示：

**slew_lower_threshold_pct_fall**：20.0；

**slew_upper_threshold_pct_fall**：80.0；

**slew_lower_threshold_pct_rise**：20.0；

**slew_upper_threshold_pct_rise**：80.0；

**slew_derate_from_library**：0.6；

在这种情况下，将**slew_derate_from_library**设置为0.6，并将压摆测量阈值点指定为20％和80％，这意味着库中的过渡时间表里的数据对应于外推到0％至100％（（80-20）/（100-0）= 0.6）的值，如图3-5所示：

![img](docs/IC/25-STA/SAT时序圣经%20翻译/03标准单元库/v2-6201aec540c861cb2684384dfaf9b655_1440w.jpg)图3-5

指定了压摆降额后，计算延迟时使用的压摆值等于：

>  库中过渡时间值 * 压摆降额系数 （ **library_transition_time_value** * **slew_derate**）
>

这就是延迟计算工具在内部使用的压摆值，是对应于指定的压摆阈值测量点的。

## 3.3 时序模型-组合逻辑单元

考虑一个两输入与门（and）的时序弧，由前面章节所述可知该单元的两个时序弧均为正单边类型（positive_unate）， 因此，输入引脚的电平上升对应于输出引脚的电平上升，反之亦然。

对于这个两输入与门，共有以下4种延时：

● A -> Z ：输出上升沿延迟（Output rise）

● A -> Z ：输出下降沿延迟（Output fall）

● B -> Z ：输出上升沿延迟（Output rise）

● B -> Z ：输出下降沿延迟（Output fall）

![img](docs/IC/25-STA/SAT时序圣经%20翻译/03标准单元库/v2-b7e384972d404c2e638bad1e88e116d1_1440w.jpg)图3-6

这意味着对于NLDM模型，将会有四个表格模型用于指定延迟。同样，也将有四个表格模型用于指定输出过渡时间（压摆）。

## 3.3.1 延迟与压摆模型

以下是一个用于分析三输入与非门（nand）单元的输入INP1到输出OUT的时序模型：

![img](docs/IC/25-STA/SAT时序圣经%20翻译/03标准单元库/v2-57437a41383049fc1e26ba69fc9340f9_1440w.jpg)

![img](docs/IC/25-STA/SAT时序圣经%20翻译/03标准单元库/v2-ae58d746091e358e4b0055e2a2d0f33c_1440w.jpg)

在上面的例子中，使用了两个单元延迟表**cell_rise**和**cell_fall**以及两个过渡时间表**rise_transition**和**fall_transition**来描述从INP1到OUT的时序弧的特性，上面的例子中还包括了输出的最大过渡时间（**max_transition**）值。

如章节2.7中所述，与非门单元中的时序弧为负单边类型（negative unate），这表示输出引脚电平跳变方向与输入引脚电平跳变方向是相反的。因此，查找**cell_rise**表对应于输入引脚上的下降过渡时间。同样，通过与门单元或者或门单元的时序弧是正单边类型（positive unate）的，因为输出引脚电平跳变方向与输入引脚电平跳变方向相同。

## 3.3.2 通用组合逻辑块

考虑以下这个具有三输入和两输出的通用组合逻辑块（General Combinational Block）：

![img](docs/IC/25-STA/SAT时序圣经%20翻译/03标准单元库/v2-3590ac2df0450e06a20faec62fa0eafb_1440w.jpg)图3-7

像这样的组合逻辑块可以具有多个时序弧。通常，从块的每个输入到每个输出都有一条时序弧。如果从输入到输出的逻辑路径是同相（non-inverting）或正单边类型的，则输出的极性（polarity）与输入的极性相同；如果逻辑路径是反相（inverting）或负单边类型，则输出的极性与输入相反，即当输入电平上升时，输出电平将下降。这些时序弧代表了通过这个组合逻辑块的传播延迟。

通过组合逻辑单元的某些时序弧可以既是正单边类型，也是负单边类型的。一个例子是通过两输入异或门（xor）单元的时序弧，根据该单元的另一个输入的逻辑状态，两输入异或门单元的输入引脚处的电平跳变会导致输出引脚处的电平沿相同或相反的方向跳变。这些时序弧可以描述为非单边类型（non-unate）的，也可以描述为两组状态相关（state-dependent）的正单边类型时序模型和负单边类型时序模型。这种与状态相关的表格模型将在3.5节中有更详细的描述。





## 3.4 时序模型-时序逻辑单元

考虑如下图3-8所示的时序逻辑单元的时序弧：

![img](docs/IC/25-STA/SAT时序圣经%20翻译/03标准单元库/v2-feda51c573c3b9fbb7a7b60a11698ec0_1440w.jpg)图3-8

对于同步（synchronous）输入，例如引脚D（或SI，SE），存在以下时序弧：

● 建立（Setup）时间检查时序弧（包括上升沿和下降沿）

● 保持（Hold）时间检查时序弧（包括上升沿和下降沿）

对于异步（asynchronous）输入，例如引脚CDN，存在以下时序弧：

● 恢复（Recovery）时间检查时序弧

● 撤销（Removal）时间检查时序弧

对于触发器的同步输出，例如引脚Q或QN，存在以下时序弧：

● 时钟引脚（CK）到输出端口（Q或QN）的传播延迟时序弧（包括上升沿和下降沿）

所有同步时序弧均相对于时钟的有效沿（active edge），即时序逻辑单元捕获数据的时钟沿。此外，时钟引脚和异步引脚（如复位引脚）还需要进行脉冲宽度（pulse width）时序检查。各种时序检查如下图3-9所示：

![img](docs/IC/25-STA/SAT时序圣经%20翻译/03标准单元库/v2-ae751dbf5fe8b0c72e3a51557efb9ddb_1440w.jpg)图3-9

## 3.4.1 同步时序检查：建立时间与保持时间

需要进行建立时间和保持时间的同步时序检查，才能确保数据能够正确通过时序单元传播。这些时序检查可验证输入的数据在时钟有效沿上是否为确定的逻辑状态，并且在有效沿上将正确的数据锁存下来。这些时序检查也可以验证输入的数据在有效时钟沿附近是否`稳定`：输入的数据必须在有效时钟沿之前保持稳定的最短时间称为建立时间（setup time）。这是根据最晚的（the latest）数据信号超过其阈值（通常为Vdd的50％）到有效时钟沿超过其阈值（通常为Vdd的50％）的时间间隔测量的。同样，保持时间（hold time）是在时钟有效沿之后输入的数据必须保持稳定的最短时间，这也是根据有效时钟沿超过其阈值到最早的（the earliest）数据信号超过其阈值的时间间隔来度量的。如前文所述，时序单元的时钟有效沿是指引起时序单元捕获数据的上升沿或下降沿。

### 建立时间与保持时间检查示例

时序单元同步引脚的建立时间和保持时间约束通常用二维表格来描述，如下所示。下面的例子展示了触发器数据引脚的建立时间和保持时间时序信息：

![img](docs/IC/25-STA/SAT时序圣经%20翻译/03标准单元库/v2-f3ab4089bd83356a2d9efa1c9a5ee7f0_1440w.jpg)

![img](docs/IC/25-STA/SAT时序圣经%20翻译/03标准单元库/v2-e01adbc8438267b688ab92ef53840fc5_1440w.jpg)

上面的例子展示了在输入引脚D上，相对于时序单元时钟引脚CK上升沿的建立时间和保持时间约束。二维表格模型是根据约束引脚**constrained_pin**（D）和相关引脚**related_pin**（CK）处的过渡时间确定的，二维表格的查找是基于库中描述模板**setuphold_template_3x3**的。对于上述示例，查找表模板**setuphold_template_3x3**如下所示：

![img](docs/IC/25-STA/SAT时序圣经%20翻译/03标准单元库/v2-9252346fb3247e556d14f0ec04cbb1ad_1440w.jpg)

/* The constrained pin and the related pin can be in either order, that is, variable_1 could be the related pin transition.
However, these designations are usually consistent across all templates in a library. */  

与前面示例中一样，表中的值如嵌套循环一样被指定，其中第一个索引**index_1**是外部循环变量，第二个索引**index_2**是内部循环变量， 以此类推。因此，当D引脚的上升沿过渡时间为0.4ns，CK引脚的上升沿过渡时间为0.84ns时，那么，D引脚上升沿的建立时间约束为0.112ns，该值是从**rise_constraint**表中读取的。对于D引脚的下降沿，建立时间约束将检查建立时间表中的**fall_constraint**表。在表中查找不到与索引值相对应过渡时间，可使用章节3.2中所描述的非线性模型查找方法。

请注意，建立时间约束的**rise_constraint**和**fall_constraint**表是指**constrained_pin**。所用的时钟过渡时间类型由**Timing_type**决定，它会指定该时序逻辑单元是上升沿触发还是下降沿触发。

### 建立时间和保持时间检查里的负值

请注意，上面示例中的某些保持时间值是负数。这是可以接受的，这种情况通常发生在触发器的引脚到数据内部锁存点的路径长于相应的时钟路径时。因此，负的保持时间检查意味着触发器的数据引脚可以在时钟引脚之前改变，并且仍然满足保持时间的检查要求。

触发器的建立时间值也可以为负。这意味着触发器的数据引脚可以在时钟引脚之后改变，并且仍然满足建立时间的检查要求。

建立时间和保持时间可以都为负吗？不行！为使建立时间和保持时间检查相一致，建立时间和保持时间的数值总和应为正。因此，如果建立（或保持）时间检查包含负值，则相应的保持（或建立）时间检查应为正值，且足够大，以使建立时间加上保持时间之和是一个正数。 具有负的保持时间值的示例如图3-10所示，由于建立时间检查会先于保持时间检查，所以此时的建立时间加上保持时间显然是一个正数。建立时间加上保持时间即为要求数据信号稳定的区域的宽度。

![img](docs/IC/25-STA/SAT时序圣经%20翻译/03标准单元库/v2-88af4f833194fbfe2f837bddbfc435c5_1440w.jpg)图3-10

对于触发器，在扫描数据（scan data）输入引脚上设置一个负的保持时间会很有帮助，这样可以给予时钟偏斜（clock skew）一定的灵活性，并且可以消除当扫描模式（scan mode）下保持时间发生违例时插入缓冲器（buffer）的需要（扫描模式是将触发器串联在一起形成一条扫描链的模式，触发器的输出通常连接到串联的下一个触发器的扫描数据输入引脚，这些连接是用于芯片测试的）。

与同步数据输入引脚上的建立时间或保持时间检查类似，对异步引脚进行的时序约束检查将在下个小节中介绍。

## 3.4.2 异步时序检查

### 恢复时间和撤销时间检查

诸如异步复位（clear）或异步置位（set）之类的异步引脚会覆盖单元的任何同步行为。当异步引脚处于有效（active）状态时，输出将由异步引脚控制，而不是由时钟锁存到的输入数据控制。但是，当异步引脚变为无效（inactive）状态时，时钟的有效边沿将开始锁存输入的数据。异步恢复（recovery）时间和撤销（removal）时间约束检查将验证异步引脚在下一个时钟有效沿处是否已明确返回到了无效状态。

恢复时间是指异步输入被置为无效（de-asserted）后在下一个时钟有效沿之前需要保持稳定的最短时间。

同样，撤销时间是指在一个有效的时钟沿之后，异步引脚必须保持有效状态的最小时间，即在有效时钟沿之后必须经过一段撤销时间才能够将异步引脚置为无效状态。

异步恢复时间和撤销时间检查将分别在8.6节和8.7节中介绍。

### 脉冲宽度检查

除了同步和异步时序检查外，还有一项检查去确保逻辑单元输入引脚上的脉冲宽度满足最低要求。例如，如果时钟引脚上的脉冲宽度小于指定的最小值，则时钟可能无法正确锁存数据。也可以为相关的同步和异步引脚指定脉冲宽度检查（pulse width check），并且可以为高脉冲和低脉冲分别指定最小脉冲宽度检查。

### 恢复时间、撤销时间和脉冲宽度检查示例

下面给出了触发器的异步清零引脚CDN的恢复时间、撤销时间和脉冲宽度检查的示例，其中恢复时间和撤销时间检查还与时钟引脚CK有关。`由于恢复时间和撤销时间检查是针对异步引脚被置为无效的时刻`，因此在以下示例中仅存在上升约束。CDN引脚的最小脉冲宽度检查用于低脉冲，这是由于CDN引脚为低电平有效，因此该引脚上的高脉冲宽度没有限制，因此未指定。

![img](docs/IC/25-STA/SAT时序圣经%20翻译/03标准单元库/v2-2df189618e0c05f97af14139388ef635_1440w.jpg)

![img](docs/IC/25-STA/SAT时序圣经%20翻译/03标准单元库/v2-9ad4d96787ee12ed3578a63b0244f52e_1440w.jpg)

## 3.4.3 传播延迟

时序单元的传播延迟（propagation delay）是指从时钟的有效沿到输出的上升沿或下降沿。以下是一个时钟下降沿触发的触发器从时钟引脚CKN到输出Q的传播延迟弧的示例。这是一个非单边类型（non-unate）的时序弧，因为时钟的有效沿会导致输出引脚Q的电平上升或下降。

![img](docs/IC/25-STA/SAT时序圣经%20翻译/03标准单元库/v2-11b60b0df2cb98d100099ae22c7ba932_1440w.jpg)

![img](docs/IC/25-STA/SAT时序圣经%20翻译/03标准单元库/v2-5ffb5dbaf08b73c0aba3c1222e99b55c_1440w.jpg)

与前一章中的示例一样，输出的传播延迟会根据输入过渡时间和输出负载电容以二维表格的形式呈现。但是在此示例中，由于触发器是时钟下降沿触发的，因此要使用的输入过渡时间是CKN引脚的下降过渡时间，这在上面的示例中可以从**Timing_type**字段中看出，上升沿触发的触发器将把**rising_edge**指定为其**timing_type**。

![img](docs/IC/25-STA/SAT时序圣经%20翻译/03标准单元库/v2-cf68c50e7470a318f227864cd534afe4_1440w.jpg)

## 3.5 状态相关的时序模型

在许多组合逻辑模块中，输入和输出之间的时序弧取决于模块中其他引脚的逻辑状态。输入和输出引脚之间的这些时序弧可以是正单边类型时序弧、负单边类型时序弧也可以既是正单边类型又是负单边类型时序弧。异或门（xor）以及同或门（xnor）单元就是一个例子，其输入到输出的时序弧可以是正单边类型的也可以是负单边类型的。 在这种情况下，其时序行为可能会有所不同，具体取决于该模块其他输入的状态。通常，取决于引脚状态的多个时序模型被称为状态相关的时序模型（state-dependent models）。

考虑一个两输入异或门单元的例子。当另一个输入A2为逻辑0时，从输入A1到输出Z的时序路径为正单边类型；当输入A2为逻辑1时，从A1到Z的路径为负单边类型。这两个时序模型是使用状态相关的时序模型指定的。A2为逻辑0时从A1到Z的时序模型如下所示：

![img](docs/IC/25-STA/SAT时序圣经%20翻译/03标准单元库/v2-1d24ac9080f54ed69fec3f5a26321715_1440w.jpg)

![img](docs/IC/25-STA/SAT时序圣经%20翻译/03标准单元库/v2-e63bc07d8d6b568fda8e53ce45028fc3_1440w.jpg)

使用**when**来指定与状态有关的条件。虽然以上单元模型的片段仅说明了**cell_rise**延迟，但其它时序模型（**cell_fall**，**rise_transition**和**fall_transition**）也指定了相同的**when**条件。当**when**中条件改变，如改为A2为逻辑1这个条件时，会指定另一个独立的时序模型：

![img](docs/IC/25-STA/SAT时序圣经%20翻译/03标准单元库/v2-ee5f3576374dbc54c303957b78ea5d2e_1440w.jpg)

**sdf_cond**用于指定生成**SDF**文件时要使用的时序弧的条件，详情参见后面3.9节中的示例。

状态相关的时序模型可用于各种类型的时序弧，许多时序逻辑单元会使用状态相关的时序模型指定建立时间或保持时间的时序约束。以下是使用状态相关的时序模型进行保持时间约束的扫描触发器（scan flip-flop）的一个示例。在这种情况下，指定了两组时序模型：扫描使能引脚SE处于有效状态时的一组，以及扫描使能引脚处于无效状态时的另一组。

![img](docs/IC/25-STA/SAT时序圣经%20翻译/03标准单元库/v2-ad2b03435ddc02178c4fb6cbadaa6000_1440w.jpg)

当扫描使能引脚SE为逻辑0时使用以上时序模型，当**when**中条件为SE是高电平时也有类似的时序模型。

可以既使用状态相关的时序模型又使用非状态相关的时序模型来指定一些时序关系。在这种情况下，如果单元的状态是已知的并且这个状态包含在状态相关的时序模型之一中，则时序分析将使用状态相关的时序模型。而如果状态相关的时序模型未包含单元的这个状态，则使用来自非状态相关模型的时序。例如考虑一种情况，保持时间约束仅由当**when**条件为SE处于逻辑0时来指定，而没有为SE处于逻辑1时指定单独的状态相关模型。在这种情况下，如果SE被置为逻辑1，则将会使用非状态相关时序模型的保持时间约束。而如果没有用于保持时间约束的非状态相关时序模型，那么将没有任何有效的保持时间约束！

可以为时序库中的任何属性指定状态相关的模型，因此可以存在功率、漏电功率、过渡时间、上升和下降延迟、时序约束等状态相关的模型。下面给出了一个状态相关的漏电功率模型示例：

![img](docs/IC/25-STA/SAT时序圣经%20翻译/03标准单元库/v2-8d7f8a0a2fe00153136c3913943ba740_1440w.jpg)

## 3.6 黑盒的接口时序模型

本节将介绍黑盒（任意模块或块）的IO接口时序弧，时序模型将捕获黑盒（black box）IO接口（interface）的时序。黑盒的接口时序模型可以具有组合逻辑弧，也可以有时序逻辑弧。通常，这些时序弧也可能取决于状态。

![img](docs/IC/25-STA/SAT时序圣经%20翻译/03标准单元库/v2-f9b5cc6b7c255cc3188c5098f38b878e_1440w.jpg)图3-11

对于如图3-11所示的例子，可以将时序弧分为以下几类：

● 输入到输出的组合逻辑弧：这对应于直接从输入到输出的组合逻辑路径，例如从输入端口FIN到输出端口FOUT。

● 输入时序逻辑弧：这对应于连接到触发器D引脚的输入端口的建立时间或保持时间。通常，在将模块的输入端口连接到触发器的D引脚之前，可以存在一些组合逻辑。这样的一个例子是在输入端口DIN上相对于时钟端口ACLK的建立时间检查。

● 输出时序逻辑弧：这类似于触发器时钟端到输出端Q的传播延迟。通常，触发器输出引脚与模块输出端口之间可以存在一些组合逻辑。一个示例是从时钟BCLK到触发器UFF1的输出引脚再到输出端口DOUT的路径。

● 异步输入时序弧：这类似于触发器异步输入引脚的恢复时间和撤销时间时序约束，例如输入端口ARST到触发器UFF0的异步清零引脚。

除上述时序弧外，在黑盒的外部时钟引脚上还可以进行脉冲宽度检查。还可以定义内部节点（node）并在这些内部节点上定义衍生时钟（generated clock），从而指定在这些节点之间的时序弧。总之，黑盒模型可以具有以下时序弧：

● 纯组合逻辑路径的输入到输出时序弧（Input to output timing arcs）

● 从同步输入端口到相关时钟端口的建立时间和保持时间时序弧（Setup and hold timing arcs）

● 从异步输入端口到相关时钟端口的恢复时间和撤销时间时序弧（Recovery and removal timing arcs）

● 从时钟端口到输出端口的输出传播延迟（Output propagation delay）

如上所述的接口时序模型并非旨在捕获黑盒的内部时序，而只是捕获其接口上的时序。

## 3.7 高级时序建模

非线性延迟模型（NLDM）这类的时序模型是基于输出负载电容和输入过渡时间来表示通过时序弧的延迟的。实际上，单元输出的负载不仅包括电容还应当包括互连电阻（interconnect resistance）。由于NLDM方法假设输出负载为纯电容，因此互连电阻成为了一个问题。即使互连电阻不为零，但当互连电阻的影响较小时，仍使用了这些NLDM模型。在互连电阻存在的情况下，延迟的计算方法通过在单元的输出端获得等效的有效电容（effective capacitance）来改进NLDM模型。延迟计算工具中使用的“有效”电容法获得的等效电容可保证单元输出延迟与具有RC互连的单元输出延迟相同。有效电容法将在5.2节里的延迟计算部分再详细介绍。

随着特征尺寸的缩小，由于波形变得高度非线性，互连电阻的影响会导致较大的误差，各种建模方法为单元的输出驱动能力提供了更高的精度。通常，这些方法通过用等效电流源对驱动器（driver）的输出级进行建模来获得更高的精度。例如**CCS**（**C**omposite **C**urrent **S**ource）复合电流源或**ECSM**（**E**ffective **C**urrent **S**ource **M**odel）有效电流源模型：**CCS**时序模型通过使用随时间变化且依赖电压的电流源，为建模单元输出驱动能力提供了更高的精度。通过为不同情况下的接收引脚电容（receiver pin capacitance）和输出充电电流（output charging currents）指定详细时序模型，可以提供时序信息。接下来描述**CCS**模型的细节。

## 3.7.1 接收引脚电容

接收引脚电容对应于NLDM模型中指定的输入引脚电容（input pin capacitance）。与NLDM模型的输入引脚电容不同，CCS模型允许在过渡波形的不同部分分别指定接收引脚电容。由于互连RC和由单元内部输入设备的米勒效应（Miller effect）所引起的等效输入非线性电容，接收引脚电容值会在过渡波形的不同点处发生变化。因此，该电容值在波形的初始部分（leading portion）与在波形的后续部分（trailing portion）的建模是不同的。

接收电容可以在引脚级别（pin level）上指定（如NLDM模型），通过该引脚的所有时序弧都使用该电容值；或者，接收电容可以在时序弧（timing arc level）级别上指定，在这种情况下可以为不同的时序弧指定不同的电容模型。接下来将介绍这两种指定接收引脚电容的方法。

### 在引脚级别指定电容

当在引脚级别指定电容时，接收引脚电容的一维表格示例如下：

![img](docs/IC/25-STA/SAT时序圣经%20翻译/03标准单元库/v2-9f14ee6e9286aaca528d78ef4770a82c_1440w.jpg)

**index_1**指定了此引脚输入过渡时间的索引值，一维表格**values**为波形的初始部分指定了输入引脚上用于上升沿波形的接收电容。

与上面示例中的**receiver_capacitance1_rise**表格类似，**receiver_capacitance2_rise**表格为波形的后续部分指定了输入引脚上用于上升沿波形的接收电容。而下降电容（用于下降沿输入波形的引脚电容）分别由表格**receiver_capacitance1_fall**和**receiver_capacitance2_fall**指定。

### 在时序弧级别指定电容

接收引脚电容值也可以在时序弧级别上，根据输入过渡时间和输出负载以二维表格的形式来指定。以下给出了在时序弧级别指定电容的示例。本示例指定了输入引脚IN上波形初始部分的接收引脚上升电容，该电容取决于输入引脚IN上的过渡时间和输出引脚OUT上的负载。

![img](docs/IC/25-STA/SAT时序圣经%20翻译/03标准单元库/v2-25a47e9f7d7ed1b80ecf5b0249da2a12_1440w.jpg)

![img](docs/IC/25-STA/SAT时序圣经%20翻译/03标准单元库/v2-0593657515051dfbbd2d6abd42c55979_1440w.jpg)

上面的示例指定了**receiver_capacitance1_rise**的模型，库中也包含有关**receiver_capacitance2_rise**、**receiver_capacitance1_fall**和**receiver_capacitance2_fall**的类似定义。

下表总结了四种不同类型的接收电容类型。如上所述，可以在引脚级别将它们指定为一维表格，或在时序弧级别将它们指定为二维表格。

![img](docs/IC/25-STA/SAT时序圣经%20翻译/03标准单元库/v2-e1c7488114abed0408ac8b8dafae744f_1440w.jpg)

## 3.7.2 输出电流

在CCS模型中，非线性时序表现为输出电流。输出电流信息被指定为一个查找表，该表的查找取决于输入过渡时间和输出负载。

输出电流会根据输入过渡时间和输出负载电容的不同组合被指定，对于每一个组合，都将分别指定一个输出电流波形。本质上，此处的波形指的是随时间变化的输出电流值。以下示例使用**output_current_fall**指定了用于下降输出波形的输出电流：

![img](docs/IC/25-STA/SAT时序圣经%20翻译/03标准单元库/v2-57b07262faf6814cf72ee0bf265e8fec_1440w.jpg)

**reference_time**是指输入波形超过延迟阈值的时间，**index_1**和**index_2**是指输入过渡时间和所使用的输出负载电容，而**index_3**是时间。**index_1**和**index_2**（输入过渡时间和输出负载电容）只能有一个值，**index_3**是指时间值，表值是指相应的输出电流。因此，对于给定的输入过渡时间和输出负载，输出电流波形是时间的函数。同样，还指定了用于输入过渡时间和输出电容的其他组合的查找表。

类似地可以使用**output_current_rise**去指定上升输出波形的输出电流。

## 3.7.3 串扰噪声分析模型

本节介绍用于串扰噪声（或毛刺）分析的CCS模型，又被称为**CCSN**（**CCS** **N**oise）模型。CCS噪声模型是结构（structural）模型，并针对单元内的不同沟道连接块-CCB（Channel Connected Blocks）表示。

什么是CCB？ CCB是指单元的源极（source）-漏极（drain）的沟道（channel）连接部分。例如，单级（single stage）单元（例如反相器、与非门和或非门单元）仅包含一个CCB，即整个单元仅通过一个沟道连接区域进行连接，而多级单元（例如与门和或门单元）包含多个CCB。

通常仅为由单元输入驱动的第一个CCB和驱动单元输出的最后一个CCB指定CCSN模型，并且会使用稳态电流、输出电压和传播噪声模型来指定这些CCSN模型。

对于单级组合逻辑单元（例如与非门和或非门单元），将为每个时序弧指定CCS噪声模型。 这些单元只有一个CCB，因此模型将会是从单元的输入引脚到输出引脚的。

以下是一个与非门单元的模型示例：

![img](docs/IC/25-STA/SAT时序圣经%20翻译/03标准单元库/v2-54d19f4c7da8ea514c5622d4c9afb273_1440w.jpg)

![img](docs/IC/25-STA/SAT时序圣经%20翻译/03标准单元库/v2-dd2c4fd6ba88110bc706a66c665ea982_1440w.jpg)

现在我们描述CCS噪声模型的属性：**ccsn_first_stage**字段表示该模型用于与非门单元的第一级CCB。如前所述，与非门单元只有一个CCB。**is_needed**字段几乎始终为**true**，但天线单元（antenna cell）等非功能性单元除外。**stage_type**字段中的**both**表示该级CCB同时具有上拉（pull-up）和下拉（pull-down）结构。**miller_cap_rise**和**miller_cap_fall**分别代表输出上升和下降过渡时的米勒（Miller）电容值。

### 直流电流

**dc_current**表中为输出引脚上针对输入和输出引脚电压不同组合的的直流电流，其中**index_1**为输入电压，**index_2**为输出电压， 二维表格中的数值为CCB输出处的直流电流。输入电压和输出电流均在库中指定单位（通常为伏特和毫安）。对于从与非门单元的输入引脚IN1到输出引脚OUT的CCS噪声模型示例，当输入电压为-0.9V并且输出电压为0V时，输出端的直流电流为0.42mA。

### 输出电压

**output_voltage_rise**和**output_voltage_fall**表中分别包含CCB输出上升和下降的时序信息。这些表格是CCB输出节点的多维表格，指定了针对不同输入过渡时间和输出电容的上升和下降输出电压。每个表格的**index_1**指定了轨到轨输入过渡时间，**index_2**指定了输出电容，**index_3**指定了输出电压超过特定阈值点的时间（在这种情况下，为0.9V的Vdd电源的30％，70％和90％）。在每个多维表中，电压交叉点（voltage crossing points）是固定的，并且CCB输出节点与电压交叉时的时间值在**index_3**中指定。

### 噪声传播

**propagated_noise_high**模型和**propagated_noise_low**模型指定的多维表格提供了通过CCB的噪声传播信息。这些模型表征了串扰毛刺（或噪声）从CCB的输入到输出的传播，表征时输入端使用了对称的三角波。噪声传播的多维表被组织为了多个表，这些表指定了CCB输出处的毛刺波形。这些多维表包含：

● 输入毛刺幅值（**index_1**）

● 输入毛刺宽度（**index_2**）

● CCB输出电容（**index_3**）

● 时间（**index_4**）

表格中的数值指定了CCB输出电压（或通过CCB传播的噪声）。

### 两级单元的噪声模型

与单级单元一样，两级单元（例如与门和或门单元）的CCS噪声模型通常被描述为时序弧的一部分。由于这些单元包含两个单独的CCB，因此需要分别为**ccsn_first_stage**和**ccsn_last_stage**指定噪声模型。例如，对于两输入与门单元，CCS噪声模型由第一级和最后一级相互独立的模型组成，如下所示：

![img](docs/IC/25-STA/SAT时序圣经%20翻译/03标准单元库/v2-3cfba89e2472a20357480a0d3ca0c9ee_1440w.jpg)

为IN2引脚指定的**ccsn_last_stage**中的模型与为IN1引脚指定的**ccsn_last_stage**中的模型是相同的。

### 多级单元和时序单元的噪声模型

通常将较为复杂的组合逻辑单元或时序逻辑单元的CCS噪声模型描述为引脚规范（pin specification）的一部分，这与前面在单级或二级单元的CCS噪声模型中以引脚对（pin-pair）为基础，指定为时序弧的一部分是不同的。通常由所有输入引脚的**ccsn_first_stage**模型和所有输出引脚的**ccsn_last_stage**模型描述复杂的多级和时序单元。这些单元的CCS噪声模型不是时序弧的一部分，但通常是为引脚指定的。

如果输入和输出之间的内部路径多达两级CCB，则噪声模型也可以表示为引脚对时序弧的一部分。通常，多级单元中可以将某些CCS噪声模型指定为引脚对时序弧的一部分，而其他一些噪声模型可以通过引脚说明来指定。

下面的示例使用引脚说明以及时序弧的一部分指定了CCS噪声模型：

![img](docs/IC/25-STA/SAT时序圣经%20翻译/03标准单元库/v2-bf9b86c76e53609f09a41237af6eacab_1440w.jpg)

![img](docs/IC/25-STA/SAT时序圣经%20翻译/03标准单元库/v2-8766dda3f943739c2d97776f841df329_1440w.jpg)

请注意，上述触发器单元的某些CCS模型是通过引脚定义的。使用输入引脚上的引脚说明定义的指定为**ccsn_first_stage**，而输出引脚QN上的CCS模型指定为**ccsn_last_stage**。另外，两级CCS噪声模型被描述为CDN到Q的时序弧的一部分。因此本示例表明，一个单元可以具有指定为引脚说明一部分和时序弧一部分的CCS模型。

## 3.7.4 其它噪声模型

除了上述CCS噪声模型之外，某些单元库还提供了其他模型来表征噪声。早在CCS噪声模型出现之前，就已经使用了其中一些模型。如果CCS噪声模型可用，则不需要这些附加模型。为了完整起见，我们在下面介绍一些早期的噪声模型。

直流裕度模型（**Models for DC margin**）：直流裕度是指单元输入引脚允许的最大直流变化（DC variation），它将使单元保持稳定状态，即不会在输出端引起毛刺。例如，低电平输入的直流裕度指的是输入引脚上最大的直流电压值，而不会在输出端引起任何电平跳变。

抗扰度模型（**Models for noise immunity**）：抗扰度模型指定输入引脚可以允许的毛刺幅度（glitch magnitude）。通常以二维表的形式来描述，其中毛刺宽度和输出电容为两个索引量，表中的值对应于输入引脚可以允许的毛刺幅度。这意味着任何小于指定幅度和宽度的毛刺都不会通过单元传播。抗扰度模型还具有不同变形形式，例如：

● **noise_immunity_high**

● **noise_immunity_low**

● **noise_immunity_above_high**

● **noise_immunity_below_low**

## 3.8 功耗建模

单元库中也包含与单元功耗有关的信息，包括有功功率（active power）以及待机（standby）或漏电（leakage）功率。顾名思义，有功功率与设计中的行为有关，而待机功率是待机模式下的功耗，这主要是由于漏电引起的。

## 3.8.1 有功功率

有功功率与单元输入和输出引脚上的行为有关。单元中的有功功率是由于输出负载的充电以及内部的开关引起的，通常分别称这两个为输出开关功率（output switching power）和内部开关功率（internal switching power）。

输出开关功率与单元类型无关，仅取决于输出负载电容、开关频率和供电电源；内部开关功率取决于单元的类型，因此该值会包含在单元库中，接下来将介绍库中的内部开关功率。

内部开关功率在单元库中被称为**internal power**，这是当单元的输入或输出处于活动状态时单元内部的功耗。对于组合逻辑单元，输入引脚的电平跳变会导致输出引脚的电平跳变，从而导致内部开关功耗。例如，每当输入引脚电平跳变（上升或下降）时，反相器单元就会消耗功率。 库中描述的内部开关功率如下所示：

![img](docs/IC/25-STA/SAT时序圣经%20翻译/03标准单元库/v2-2e501fad0b7e642d40cd3a4bbde8dbc1_1440w.jpg)

![img](docs/IC/25-STA/SAT时序圣经%20翻译/03标准单元库/v2-c11d667c7959c0dbe2b6d6e9639009c5_1440w.jpg)

上面的示例展示了单元从输入引脚A到输出引脚Z1的功耗，模板中的2x2表是根据引脚A上的输入过渡时间和引脚Z1上的输出电容来确定的。注意，尽管该表包含了输出电容，但表中的值仅对应于内部开关，不包括输出电容的影响。该值表示每个开关转换（上升或下降）时在单元中耗散的内部能量，单位是从库中的其他单位导出的（通常电压以伏特V为单位，电容以皮法拉pF为单位，并且表示为以皮焦耳pJ为单位的能量）。因此，库中的内部开关功率实际上是指每次开关转换时内部所消耗的能量。

除了内部开关功率表之外，上面的示例中还给出了电源引脚、接地引脚的说明，并且指定了可将单元断电的条件。这些构造允许在设计和方案中使用多个电源，在这些情况下可以关闭不同的电源。下面展示了单元的电源引脚说明：

![img](docs/IC/25-STA/SAT时序圣经%20翻译/03标准单元库/v2-0a65a297ed368bf5a2ae0dd20ad60c76_1440w.jpg)

![img](docs/IC/25-STA/SAT时序圣经%20翻译/03标准单元库/v2-17132af077f04b955bf430b67e751e28_1440w.jpg)

功率描述的语法允许上升和下降（指输出过渡方向）功率使用单独的构造。就像时序弧一样，功率描述也可能取决于状态。例如，可以将异或门（XOR）单元的状态相关功耗指定为取决于各种输入的状态。

对于组合逻辑单元，开关功率是基于输入-输出引脚对指定的。但是，对于诸如具有互补输出Q和QN的触发器之类的时序单元来说，CLK-> Q转换也会导致CLK-> QN转换。因此，该库可以将内部开关功率指定为三维表格，如下所示。下例中的三个维度分别是CLK的输入压摆（input slew）和Q与QN的输出电容。

![img](docs/IC/25-STA/SAT时序圣经%20翻译/03标准单元库/v2-efd6637dd24de18173c10a761a6cf198_1440w.jpg)

![img](docs/IC/25-STA/SAT时序圣经%20翻译/03标准单元库/v2-96d1c9f4e001c06d17c9a446bfbc4625_1440w.jpg)

即使输出和内部状态没有转换，也可以消耗开关功率。一个常见的例子是在触发器的时钟引脚上切换（toggle）的时钟。触发器在每次时钟切换时都会消耗功率，通常是由触发器单元内部反相器的开关所带来的。即使触发器输出未切换，也会消耗由于时钟引脚切换引起的功率。因此，对于时序逻辑单元，输入引脚功率（input pin power）是指单元内部的功耗，即输出不切换时的功耗。以下例子中描述了输入引脚功率：

![img](docs/IC/25-STA/SAT时序圣经%20翻译/03标准单元库/v2-2871b98c494bf3d3ea3b0ecd36e08e27_1440w.jpg)

上述例子展示了CLK引脚切换时的功率说明，它表示即使输出未切换，时钟切换也会导致功耗。

### 时钟引脚的功率是否被重复计算了？

注意，触发器还包含由于CLK-> Q转换引起的功耗。因此重要的是，CLK-> Q功率描述表格中的值是不包括与CLK内部功率有关的影响的，CLK内部功率与输出Q不切换时的状况相对应。

以上内容涉及到了应用工具对功率表使用的一致性，能够确保在功率计算期间与时钟输入有关的内部功率不会被重复计算。

## 3.8.2 漏电功率

大多数标准单元的设计都仅在输出或状态发生变化时才消耗功率。单元通了电但没有任何行为时，所有功耗都归因于泄漏电流（leakage current）。泄漏可能是由于MOS器件的亚阈值电流引起的，也可能是由于通过栅极氧化物的隧穿电流引起的。在以前的CMOS工艺技术中，漏电功率可以忽略不计，并且在设计过程中并不是主要考虑因素。但是，随着技术的发展，漏电功率变得越来越大，与有功功率相比，漏电功率已经无法忽略不计了。

如上所述，漏电功率主要有两个来源：MOS器件中的亚阈值电流和栅氧化物隧穿。通过使用高阈值电压单元，可以降低亚阈值电流；然而，由于高阈值电压单元的速度较低而存在一个折中（trade-off）：高阈值电压单元的漏电较小，但速度较慢。同样，低阈值电压单元的漏电较大，但速度较高。无论是使用高阈值电压还是低阈值电压的单元，栅极氧化物隧穿带来的影响都差不多。因此，控制漏电功率的可能方法是使用高阈值电压的单元。类似于在高阈值电压和标准阈值电压单元之间进行选择，设计中使用的单元强度（strength）也是一种漏电和速度之间的折中。强度较高的单元具有较高的漏电功率，但速度较高。与功率管理有关的折中将在10.6节中详细介绍。

MOS器件的亚阈值泄漏电流与温度具有很强的非线性特性，在大多数工艺技术中，随着器件温度从25°C升高到125°C，亚阈值泄漏电流可能会增加10倍至20倍。栅极氧化物隧穿带来的影响基本不随温度或器件阈值电压而改变，在100nm及以上工艺技术中可以忽略的栅极氧化物隧穿已成为65nm或更精细技术在较低温度下漏电的主要原因。例如，对于65nm或更精细的工艺技术，栅极氧化物隧穿漏电量可能等于室温下的亚阈值漏电量。而在高温下，亚阈值漏电仍然是导致漏电功率的主要因素。

库中的每个单元都被指定了漏电功率。例如，反相器单元的漏电功率可能描述如下：

![img](docs/IC/25-STA/SAT时序圣经%20翻译/03标准单元库/v2-a84f8a8fa0327da8f58264ac935bf31b_1440w.png)

这是单元中耗散的漏电功率，漏电功率单位在库的头文件中指定，通常以纳瓦为单位。通常，漏电功率还取决于单元的状态，可以使用**when**条件指定状态相关值。

例如，一个反相器单元可以具有如下描述：

![img](docs/IC/25-STA/SAT时序圣经%20翻译/03标准单元库/v2-b9fe9444269622d27050d92529b8e2e4_1440w.jpg)

其中I是反相器单元的输入引脚。需要注意的是，上例中的描述还包括了一个默认值（在**when**条件之外），该默认值通常是在**when**条件内指定值的平均值。

## 3.9 单元库中的其它属性

除时序信息外，库中的单元描述还指定了单元面积、功能和时序弧的SDF条件。这些将在本节中进行简要描述，有关更多详细信息，请参阅**Liberty**手册。

### 单元面积

面积描述中指定了一个单元或一组单元的面积：

 **area**：2.35

上面指定了单元的面积为2.35个面积单位，这可以代表单元实际使用的硅面积，也可以是面积的相对测量值。

### 单元功能

功能描述中指定了一个引脚或一组引脚的功能：

![img](docs/IC/25-STA/SAT时序圣经%20翻译/03标准单元库/v2-5282e70aa7a23f349250292aac6c5619_1440w.png)

上面指定了一个两输入与门单元输出引脚Z的逻辑功能。

### SDF条件

SDF条件属性支持标准延迟格式SDF（Standard Delay Format）文件的生成以及在反标（backannotation）期间的条件匹配。就像**when**条件指定用于时序分析的状态相关模型的条件一样，SDF标注（annotation）时状态相关时序的相应条件由**sdf_cond**来表示。以下是一个示例：

![img](docs/IC/25-STA/SAT时序圣经%20翻译/03标准单元库/v2-c5d321b65b899dafe79c4bfcb2b86a0b_1440w.jpg)

## 3.10 特征和工作条件

单元库中还会指定创建该库的特征（characterization）和工作条件。例如，库文件的头部可能包含以下内容：

![img](docs/IC/25-STA/SAT时序圣经%20翻译/03标准单元库/v2-e98430c27156aef6e3d012d6ca8a58e6_1440w.jpg)

工作条件（**nom_process**、**nom_temperature**和**nom_voltage**）指定了对库进行表征的工艺、电压和温度， 也指定了使用该库中单元的条件。如果特征和工作条件不同，则需要对延迟计算过程中获得的时序值进行降额（derate）处理， 这可以通过使用库中指定的降额系数（k-系数）来实现。

在除用于表征之外的条件下使用降额获得时序值会导致时序计算不准确。只有当无法在预期的条件下表征库时，才能使用降额过程。

### 什么是工艺变量？

与作为物理量的温度和电压不同，工艺是不可量化的变量。就数字特征和验证而言，它可能是缓慢（slow）、典型（typical）或快速（fast）的工艺之一。因此，工艺值为1.0（或任何其它值）是什么意思？答案在下面。

库的表征是一个耗时的过程，针对各种工艺角（process corner）对库进行表征可能需要数周的时间，工艺变量的设置使得以特定工艺角为特征的库可以用于不同工艺角的时序计算。工艺的k-系数可用于完成从特征库工艺到目标工艺的延迟降额。如上所述，降额系数的使用在时序计算期间引入了不准确性，跨工艺条件进行降额尤其不准确，因此很少采用。总而言之，指定不同工艺变量值（例如1.0或任何其它值）的唯一功能就是在少数情况下允许跨工艺条件进行降额处理。

## 3.10.1 使用K-系数降额

如上所述，当工作条件不同于表征条件时，降额系数（或称k-系数）可用于计算延迟，k-系数是近似系数。库中k-系数的示例如下所示：

![img](docs/IC/25-STA/SAT时序圣经%20翻译/03标准单元库/v2-9e19c6fbb2fa24006648b1601747ee64_1440w.jpg)

![img](docs/IC/25-STA/SAT时序圣经%20翻译/03标准单元库/v2-6c52b0758154d1577bdad8b0c2bbae17_1440w.jpg)

当延迟计算过程中工作条件的工艺、电压或温度与库中的标称条件不同时，可使用这些系数来进行计算。注意，**k_volt**系数为负，这意味着延迟随着电压的增加而减小，而**k_temp**因子为正，这意味着延迟通常随温度的升高而增加（除非单元具有2.10节中所描述的温度反转现象）。k-系数的用法如下：

● 降额后延迟 = 库中原始延迟 * （1 + k_process * Process + k_volt * Temp）

例如，假设使用slow工艺模型在1.08V和125°C下表征了一个库。如果要获得1.14V和100°C的延迟，则slow工艺模型的单元上升延迟可以通过以下计算获得：

● 降额后延迟 = 库中原始延迟 * （1 + k_volt_cell_rise * 0.06 - k_temp_cell_rise * 25）

假设使用上例中的k-系数代入以上计算公式，可得：

● 降额后延迟 = 库中原始延迟 * （1 - 0.42 * 0.06 - 0.0012 * 25） = 库中原始延迟 * 0.9448

可见，在降额条件下的延迟约为原始延迟的94.48％。

## 3.10.2 库中各单位

单元描述中数值的单位都是在库中指定的，可使用**Liberty**命令集在库文件中声明单位。电压、时间、电容和电阻的单位声明如下例所示：

![img](docs/IC/25-STA/SAT时序圣经%20翻译/03标准单元库/v2-f33c2226d055e9589b4e24ed99139d82_1440w.png)

![img](docs/IC/25-STA/SAT时序圣经%20翻译/03标准单元库/v2-db6930c2b1f63bb36186bde6e3e1f571_1440w.jpg)

在本书中，我们假设库中时间单位为纳秒（ns），电压单位为伏特（V），每转换一次的内部功率单位为皮焦耳（pJ），漏电功率单位为纳瓦（nW），电容单位为皮法（pF），电阻单位为Kohms，面积单位为平方微米，但明确有特殊说明的情况除外。







